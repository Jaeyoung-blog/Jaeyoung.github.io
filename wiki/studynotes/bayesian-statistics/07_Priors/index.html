<!DOCTYPE html>
<html lang="ko">

<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png">
    

    <title>
        
          07. Priors - Jaeyoung&#39;s Blog
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    <link rel="stylesheet" href="/css/book.css">
    <script src="/js/book.js"></script>

    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>JAEYOUNG&#39;S BLOG</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/"><strong>Home</strong></a></li>
</ul>
<h1 id="Study-Notes"><strong>Study Notes</strong></h1>
<h2 id="Machine-Learning">Machine Learning</h2>
<ul>
<li><a href="/wiki/studynotes/machine-learning/Machine-Learning">Machine Learning</a></li>
<li><a href="/wiki/studynotes/machine-learning/KL-Divergence">KL Divergence</a></li>
<li><a href="/wiki/studynotes/machine-learning/Principal-Component-Analysis">Principal Component Analysis</a></li>
<li><a href="/wiki/studynotes/machine-learning/Restrict-Boltzmann-Machines-1st">Restrict Boltzmann Machine 1</a></li>
<li><a href="/wiki/studynotes/machine-learning/Restrict-Boltzmann-Machines-2nd">Restrict Boltzmann Machine 2</a></li>
<li><a href="/wiki/studynotes/machine-learning/Lagrangian-Multiplier">Lagrangian Multiplier</a></li>
<li><a href="/wiki/studynotes/machine-learning/Hidden-Markov-Models-1">Hidden Markov Models 1</a></li>
<li><a href="/wiki/studynotes/machine-learning/Hidden-Markov-Models-2">Hidden Markov Models 2</a></li>
</ul>
<h2 id="Bayesian-Statistics">Bayesian Statistics</h2>
<ul>
<li><a href="/wiki/studynotes/bayesian-statistics/01_Probability">01. Probability</a></li>
<li><a href="/wiki/studynotes/bayesian-statistics/02_Distribution">02. Distribution</a></li>
<li><a href="/wiki/studynotes/bayesian-statistics/03_Frequentist_Inference">03. Frequentist Inference</a></li>
<li><a href="/wiki/studynotes/bayesian-statistics/04_Bayesian_Inference">04. Bayesian Inference</a></li>
<li><a href="/wiki/studynotes/bayesian-statistics/05_Credible_Intervals">05. Credible Intervals</a></li>
<li><a href="/wiki/studynotes/bayesian-statistics/06_Prior_Posterior_predictive">06. Prior &amp; Posterior Predictive</a></li>
</ul>
<h2 id="Reinforcement-Learning">Reinforcement Learning</h2>
<h1 id="Extra"><strong>Extra</strong></h1>
<ul>
<li><a href="/wiki/Blog-Init">Blog Init</a></li>
</ul>

</div>

<script src="/js/book-menu.js"></script>
  </div>

  <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
  <div class="sidebar-toggle-inner"></div>
</div>

<script>
function add_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.add('show')  
}

function remove_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.remove('show')
}

function sidebar_toggle() {
    let sidebar_toggle = document.querySelector('.sidebar-toggle')
    let sidebar = document.querySelector('.book-sidebar')
    let content = document.querySelector('.off-canvas-content')
    if (sidebar_toggle.classList.contains('extend')) { // show
        sidebar_toggle.classList.remove('extend')
        sidebar.classList.remove('hide')
        content.classList.remove('extend')
    }
    else { // hide
        sidebar_toggle.classList.add('extend')
        sidebar.classList.add('hide')
        content.classList.add('extend')
    }
}
</script>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <h1>Priors</h1>
<p>Prior를 어떤 분포로 선택할지에 대해서는 conjugatation을 고려해야 한다. prior으로 선택한 distribution이 likelihood와 곱해져서 posterior가 되었을 때도 그 distribution이 되어야 한다는 의미이다.</p>
<h2 id="Effective-Sample-Size">Effective Sample Size</h2>
<p>Effective sample size란, 설정한 prior의 영향이 posterior에 영향을 50%만 미치는 순간의 샘플 개수를 말한다. 샘플 개수가 적으면 prior는 posterior에 영향을 많이 미칠 테지만, effective sample size이상의 샘플을 모은다면, prior가 posterior에 미치는 영향이 50% 이내일 것이다.</p>
<h2 id="Priors-in-Binomial-Likelihood">Priors in Binomial Likelihood</h2>
<p>예를들어, binomial distribution으로 likelihood를 모델링하는 경우, 즉, 제품 생산과정에서 불량의 빈도수 같은 경우는 prior를 beta distribution으로 불량일 확률 $\theta$를 모델링한다.</p>
<p>이때, beta distribution의 parameter $\alpha$와 $\beta$를 어떻게 정해야 할까, beta distribution의 평균은 $\frac{\alpha}{\alpha+\beta}$라는 것을 기억한다. 만약, 우리가 0.3%확률로 불량이 나올 것이라고 믿는다면, $\frac{\alpha}{\alpha + \beta}=0.3$이 되게끔 정하면 된다. 다만, 이러면 경우의 수가 많은데, $\alpha$와 $\beta$값이 커지면 그 믿음에 자신감이 있는 것이다.</p>
<p>30%의 확률로 불량이 있다고 생각해서 불량률 $\theta$에 대해 $\theta \approx \text{beta}(6, 14)$으로 prior를 설정했다고 하자. 그리고 10번의 생산 후 6개의 불량이 나왔다. 이때, $\theta$의 posterior는 $\text{beta}(6+6, 14+4) = \text{beta}(12, 18)$이 된다. <strong>$\alpha$는 불량인 것의 개수와 관련있고, $\beta$는 불량이 아닌 것과 관련이 있는 것이다.</strong> 실제로 계산해봐도 그렇다.<br>
$$<br>
P(\theta) = \frac{\Gamma(6 + 20)}{\Gamma(6)\Gamma(14)}\theta^{6-1}(1-\theta)^{14 - 1}<br>
$$<br>
$$<br>
P(X|\theta) = \begin{pmatrix} 10 \ 6 \end{pmatrix}\theta^6(1-\theta)^4<br>
$$</p>
<p>$$<br>
P(\theta|X) = P(X|\theta)P(\theta) = \frac{25!10!}{5!19!6!4!}\theta^{12-1}(1-\theta)^{18-1}<br>
$$</p>
<p>$$<br>
P(\theta|X) \propto \text{beta}(12, 18)<br>
$$</p>
<p>앞의 상수들은 다 상수일 뿐. 어쨌든 beta distribution에 근사된다.</p>
<h3 id="Effective-Sample-Size-2">Effective Sample Size</h3>
<p>Binomial likelihood에서 beta distribution을 $\theta$의 prior로 했을 경우, effective sample size는 $\alpha+\beta$가 된다.</p>
<p>Posterior는 다음과 같다.<br>
$$<br>
\text{Posterior}(\theta|X) = \text{Beta}(\alpha+\sum_i^n x_i, \beta + n - \sum_i^n x_i)\<br>
$$<br>
이때, posterior mean은 $\frac{\alpha + \sum_i^n x_i}{\alpha + \beta + n}$인데, 이를 더 decompose해보면, 다음 식이 나온다.<br>
$$<br>
\frac{\alpha + \sum_i^n x_i}{\alpha + \beta + n} = \frac{\alpha + \beta}{\alpha + \beta + n} \cdot \frac{\alpha}{\alpha + \beta} + \frac{n}{\alpha + \beta + n} \cdot \frac{\sum_i^n x_i}{n}<br>
$$<br>
이것은 prior mean과 data mean과의 weighted sum으로 해석할 수 있다. 즉, posterior mean은 prior mean과 data mean에 의해 영향을 받는다. 그런데, 이때, 샘플 개수 $n$이 작으면, prior의 영향력이 커진다. 반면, $n$이 커지면, data의 영향력이 커진다. $n \geq \alpha+\beta$ 일때, prior보다 데이터의 영향력이 커진다. 따라서, effective sample size는 $\alpha + \beta$이다.</p>
<p>Prior를 정의할때, $\alpha, \beta$를 크게 잡던, 작게 잡던, $\alpha$와 $\alpha+\beta$의 비율이 같으면, prior mean은 같지만, 값들이 크면, prior의 영향력이 강해지기 때문에 sample 개수를 많이 모아야 한다.</p>
<h2 id="Priors-in-Poisson-Distribution">Priors in Poisson Distribution</h2>
<p>Poisson distribution을 likelihood로 취하는 experiment에 대해서는 parameter가 $\lambda$가 된다. 즉, $\lambda$에 대한 prior가 필요한데, 이때는 Gamma distribution으로 $\lambda$의 prior를 모델링한다. Poisson distribution으로 likelihood를 모델링 할 수 있는 경우, Gamma distribution이 conjugate한 distribution이다.</p>
<p>이때, Gamma distribution의 두 파라미터 $\alpha$와 $\beta$를 정할때, gamma distribution의 평균은 $\frac{\alpha}{\beta}$인 것을 생각하자. <strong><s>$\alpha$는 event 발생 횟수, $\beta$는 총 시행 횟수와 관련이 있다.</s></strong></p>
<p>이때, poisson이므로, 1번의 시행에서 event가 여러번 발생할 수 있다. 특정 시간 안에 몇 번의 버스가 오는가?</p>
<h3 id="Effective-Sample-Size-3">Effective Sample Size</h3>
<p>Beta distribution을 prior로 삼고, posterior도 역시 beta distribution이기 때문에, effective sample size는 $\alpha+\beta$이다.</p>
<h2 id="Priors-in-Exponential-Distribution">Priors in Exponential Distribution</h2>
<p>Exponential distribution도 역시 $\lambda$를 파라미터로 하며, gamma distribution을 prior로 하면 conjugate인 prior를 만들 수 있다.</p>
<h3 id="Effective-Sample-Size-4">Effective Sample Size</h3>
<p>Gamma prior로 conjugate인 likelihood의 경우, posterior도 gamma distribution이다. 이런 경우, effective sample size는 $\beta$이다.<br>
$$<br>
\text{Posterior}(\lambda|X) = \text{Gamma}(\alpha + \sum_i^n x_i, \beta + n)<br>
$$</p>
<p>$$<br>
\text{mean}(posterior) = \frac{\alpha + \sum_i^n x_i}{\beta + n}<br>
$$</p>
<p>$$<br>
\frac{\alpha + \sum_i^n x_i}{\beta + n} = \frac{\beta}{\beta + n} \cdot \frac{\alpha}{\beta} + \frac{n}{\beta + n} \cdot \frac{\sum_i^n x_i}{n}<br>
$$</p>
<h2 id="Priors-in-Normal-Distribution">Priors in Normal Distribution</h2>
<p>Normal distribution의 파라미터 $\mu$는 $\sigma$에 의존함과 동시에 normal distribution prior에서 conjugate한다. $\sigma$는 주어젔다고 가정하는 경우가 많으며, 그렇지 않을 경우, inverse-gamma distribution에서 conjugate한다.</p>

</div>


  <div class="book-comments">
    
<script src="https://utteranc.es/client.js"
        repo="wayexists02/wayexists02.github.io"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>





  </div>


<script src="/js/book-post.js"></script>
        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/log.png" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>Lee Jaeyoung</div>
      <div>2020-03-01</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/Study-Notes/">Study Notes</a> <a class="category-link" href="/categories/Study-Notes/Bayesian-Statistics/">Bayesian Statistics</a>

      <a class="tag-link" href="/tags/BayesianStatistics/">#BayesianStatistics</a> <a class="tag-link" href="/tags/StudyNotes/">#StudyNotes</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>

<script src="/js/book-toc.js"></script>
</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>

<script src="/js/book.js"></script>